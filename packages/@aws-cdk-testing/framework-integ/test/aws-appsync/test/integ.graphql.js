"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const path_1 = require("path");
const aws_cognito_1 = require("aws-cdk-lib/aws-cognito");
const aws_dynamodb_1 = require("aws-cdk-lib/aws-dynamodb");
const aws_cdk_lib_1 = require("aws-cdk-lib");
const aws_appsync_1 = require("aws-cdk-lib/aws-appsync");
/*
 * Creates an Appsync GraphQL API and with multiple tables.
 * Testing for importing, querying, and mutability.
 *
 * Stack verification steps:
 * Add to a table through appsync GraphQL API.
 * Read from a table through appsync API.
 *
 * -- aws appsync list-graphql-apis                 -- obtain apiId               --
 * -- aws appsync get-graphql-api --api-id [apiId]  -- obtain GraphQL endpoint    --
 * -- aws appsync list-api-keys --api-id [apiId]    -- obtain api key             --
 * -- bash verify.integ.graphql.sh [apiKey] [url]   -- shows query and mutation   --
 */
const app = new aws_cdk_lib_1.App();
const stack = new aws_cdk_lib_1.Stack(app, 'aws-appsync-integ');
const userPool = new aws_cognito_1.UserPool(stack, 'Pool', {
    userPoolName: 'myPool',
});
const api = new aws_appsync_1.GraphqlApi(stack, 'Api', {
    name: 'demoapi',
    schema: aws_appsync_1.SchemaFile.fromAsset(path_1.join(__dirname, 'integ.graphql.graphql')),
    authorizationConfig: {
        defaultAuthorization: {
            authorizationType: aws_appsync_1.AuthorizationType.USER_POOL,
            userPoolConfig: {
                userPool,
            },
        },
        additionalAuthorizationModes: [
            {
                authorizationType: aws_appsync_1.AuthorizationType.API_KEY,
            },
        ],
    },
});
const noneDS = api.addNoneDataSource('none', { name: 'None' });
noneDS.createResolver('QuerygetServiceVersion', {
    typeName: 'Query',
    fieldName: 'getServiceVersion',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.fromString(JSON.stringify({
        version: '2017-02-28',
    })),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.fromString(JSON.stringify({
        version: 'v1',
    })),
});
const customerTable = new aws_dynamodb_1.Table(stack, 'CustomerTable', {
    billingMode: aws_dynamodb_1.BillingMode.PAY_PER_REQUEST,
    partitionKey: {
        name: 'id',
        type: aws_dynamodb_1.AttributeType.STRING,
    },
    removalPolicy: aws_cdk_lib_1.RemovalPolicy.DESTROY,
});
const orderTable = new aws_dynamodb_1.Table(stack, 'OrderTable', {
    billingMode: aws_dynamodb_1.BillingMode.PAY_PER_REQUEST,
    partitionKey: {
        name: 'customer',
        type: aws_dynamodb_1.AttributeType.STRING,
    },
    sortKey: {
        name: 'order',
        type: aws_dynamodb_1.AttributeType.STRING,
    },
    removalPolicy: aws_cdk_lib_1.RemovalPolicy.DESTROY,
});
orderTable.addGlobalSecondaryIndex({
    indexName: 'orderIndex',
    partitionKey: {
        name: 'order',
        type: aws_dynamodb_1.AttributeType.STRING,
    },
    sortKey: {
        name: 'customer',
        type: aws_dynamodb_1.AttributeType.STRING,
    },
});
new aws_dynamodb_1.Table(stack, 'PaymentTable', {
    billingMode: aws_dynamodb_1.BillingMode.PAY_PER_REQUEST,
    partitionKey: {
        name: 'id',
        type: aws_dynamodb_1.AttributeType.STRING,
    },
    removalPolicy: aws_cdk_lib_1.RemovalPolicy.DESTROY,
});
const paymentTable = aws_dynamodb_1.Table.fromTableName(stack, 'ImportedPaymentTable', 'PaymentTable');
const customerDS = api.addDynamoDbDataSource('customerDs', customerTable, { name: 'Customer' });
const orderDS = api.addDynamoDbDataSource('orderDs', orderTable, { name: 'Order' });
const paymentDS = api.addDynamoDbDataSource('paymentDs', paymentTable, { name: 'Payment' });
customerDS.createResolver('QueryGetCustomers', {
    typeName: 'Query',
    fieldName: 'getCustomers',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbScanTable(),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
});
customerDS.createResolver('QueryGetCustomer', {
    typeName: 'Query',
    fieldName: 'getCustomer',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbGetItem('id', 'id'),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
customerDS.createResolver('QueryGetCusomtersNotConsistent', {
    typeName: 'Query',
    fieldName: 'getCustomersNotConsistent',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbScanTable(false),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
});
customerDS.createResolver('QueryGetCustomerNotConsistent', {
    typeName: 'Query',
    fieldName: 'getCustomerNotConsistent',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbGetItem('id', 'id', false),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
customerDS.createResolver('QueryGetCustomersConsistent', {
    typeName: 'Query',
    fieldName: 'getCustomersConsistent',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbScanTable(true),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
});
customerDS.createResolver('QueryGetCustomerConsistent', {
    typeName: 'Query',
    fieldName: 'getCustomerConsistent',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbGetItem('id', 'id', true),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
customerDS.createResolver('MutationAddCustomer', {
    typeName: 'Mutation',
    fieldName: 'addCustomer',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbPutItem(aws_appsync_1.PrimaryKey.partition('id').auto(), aws_appsync_1.Values.projecting('customer')),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
customerDS.createResolver('MutationSaveCustomer', {
    typeName: 'Mutation',
    fieldName: 'saveCustomer',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbPutItem(aws_appsync_1.PrimaryKey.partition('id').is('id'), aws_appsync_1.Values.projecting('customer')),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
customerDS.createResolver('MutationSaveCustomerWithFirstOrder', {
    typeName: 'Mutation',
    fieldName: 'saveCustomerWithFirstOrder',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbPutItem(aws_appsync_1.PrimaryKey
        .partition('order').auto()
        .sort('customer').is('customer.id'), aws_appsync_1.Values
        .projecting('order')
        .attribute('referral').is('referral')),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
customerDS.createResolver('MutationRemoveCustomer', {
    typeName: 'Mutation',
    fieldName: 'removeCustomer',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbDeleteItem('id', 'id'),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
const ops = [
    { suffix: 'Eq', op: aws_appsync_1.KeyCondition.eq },
    { suffix: 'Lt', op: aws_appsync_1.KeyCondition.lt },
    { suffix: 'Le', op: aws_appsync_1.KeyCondition.le },
    { suffix: 'Gt', op: aws_appsync_1.KeyCondition.gt },
    { suffix: 'Ge', op: aws_appsync_1.KeyCondition.ge },
];
for (const { suffix, op } of ops) {
    orderDS.createResolver(`QueryGetCustomerOrders${suffix}`, {
        typeName: 'Query',
        fieldName: 'getCustomerOrders' + suffix,
        requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(op('customer', 'customer')),
        responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
    });
    orderDS.createResolver(`QueryGetOrderCustomers${suffix}`, {
        typeName: 'Query',
        fieldName: 'getOrderCustomers' + suffix,
        requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(op('order', 'order'), 'orderIndex'),
        responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
    });
}
for (const { suffix, op } of ops) {
    orderDS.createResolver(`QueryGetCustomerOrdersNotConsistent${suffix}`, {
        typeName: 'Query',
        fieldName: 'getCustomerOrdersNotConsistent' + suffix,
        requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(op('customer', 'customer'), undefined, false),
        responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
    });
    orderDS.createResolver(`QueryGetOrderCustomersNotConsistent${suffix}`, {
        typeName: 'Query',
        fieldName: 'getOrderCustomersNotConsistent' + suffix,
        requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(op('order', 'order'), 'orderIndex', false),
        responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
    });
}
for (const { suffix, op } of ops) {
    orderDS.createResolver(`QueryGetCustomerOrdersConsistent${suffix}`, {
        typeName: 'Query',
        fieldName: 'getCustomerOrdersConsistent' + suffix,
        requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(op('customer', 'customer'), undefined, true),
        responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
    });
    orderDS.createResolver(`QueryGetOrderCustomersConsistent${suffix}`, {
        typeName: 'Query',
        fieldName: 'getOrderCustomersConsistent' + suffix,
        requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(op('order', 'order'), 'orderIndex', true),
        responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
    });
}
orderDS.createResolver('QueryGetCustomerOrdersFilter', {
    typeName: 'Query',
    fieldName: 'getCustomerOrdersFilter',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(aws_appsync_1.KeyCondition.eq('customer', 'customer').and(aws_appsync_1.KeyCondition.beginsWith('order', 'order'))),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
});
orderDS.createResolver('QueryGetCustomerOrdersBetween', {
    typeName: 'Query',
    fieldName: 'getCustomerOrdersBetween',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(aws_appsync_1.KeyCondition.eq('customer', 'customer').and(aws_appsync_1.KeyCondition.between('order', 'order1', 'order2'))),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
});
orderDS.createResolver('QueryGetOrderCustomersFilter', {
    typeName: 'Query',
    fieldName: 'getOrderCustomersFilter',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(aws_appsync_1.KeyCondition.eq('order', 'order').and(aws_appsync_1.KeyCondition.beginsWith('customer', 'customer'))),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
});
orderDS.createResolver('QueryGetOrderCustomersBetween', {
    typeName: 'Query',
    fieldName: 'getOrderCustomersBetween',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbQuery(aws_appsync_1.KeyCondition.eq('order', 'order').and(aws_appsync_1.KeyCondition.between('customer', 'customer1', 'customer2')), 'orderIndex'),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultList(),
});
paymentDS.createResolver('QueryGetPayment', {
    typeName: 'Query',
    fieldName: 'getPayment',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbGetItem('id', 'id'),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
paymentDS.createResolver('QueryGetPaymentConsistent', {
    typeName: 'Query',
    fieldName: 'getPaymentConsistent',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbGetItem('id', 'id', true),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
paymentDS.createResolver('MutationSavePayment', {
    typeName: 'Mutation',
    fieldName: 'savePayment',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbPutItem(aws_appsync_1.PrimaryKey.partition('id').auto(), aws_appsync_1.Values.projecting('payment')),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.dynamoDbResultItem(),
});
const httpDS = api.addHttpDataSource('ds', 'https://aws.amazon.com/', { name: 'http' });
httpDS.createResolver('MutationDoPostOnAws', {
    typeName: 'Mutation',
    fieldName: 'doPostOnAws',
    requestMappingTemplate: aws_appsync_1.MappingTemplate.fromString(`{
    "version": "2018-05-29",
    "method": "POST",
    # if full path is https://api.xxxxxxxxx.com/posts then resourcePath would be /posts
    "resourcePath": "/path/123",
    "params":{
        "body": $util.toJson($ctx.args),
        "headers":{
            "Content-Type": "application/json",
            "Authorization": "$ctx.request.headers.Authorization"
        }
    }
  }`),
    responseMappingTemplate: aws_appsync_1.MappingTemplate.fromString(`
    ## Raise a GraphQL field error in case of a datasource invocation error
    #if($ctx.error)
      $util.error($ctx.error.message, $ctx.error.type)
    #end
    ## if the response status code is not 200, then return an error. Else return the body **
    #if($ctx.result.statusCode == 200)
        ## If response is 200, return the body.
        $ctx.result.body
    #else
        ## If response is not 200, append the response to error block.
        $utils.appendError($ctx.result.body, "$ctx.result.statusCode")
    #end
  `),
});
app.synth();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZWcuZ3JhcGhxbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImludGVnLmdyYXBocWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwrQkFBNEI7QUFDNUIseURBQW1EO0FBQ25ELDJEQUE2RTtBQUM3RSw2Q0FBd0Q7QUFDeEQseURBUWlDO0FBRWpDOzs7Ozs7Ozs7Ozs7R0FZRztBQUVILE1BQU0sR0FBRyxHQUFHLElBQUksaUJBQUcsRUFBRSxDQUFDO0FBQ3RCLE1BQU0sS0FBSyxHQUFHLElBQUksbUJBQUssQ0FBQyxHQUFHLEVBQUUsbUJBQW1CLENBQUMsQ0FBQztBQUVsRCxNQUFNLFFBQVEsR0FBRyxJQUFJLHNCQUFRLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRTtJQUMzQyxZQUFZLEVBQUUsUUFBUTtDQUN2QixDQUFDLENBQUM7QUFFSCxNQUFNLEdBQUcsR0FBRyxJQUFJLHdCQUFVLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRTtJQUN2QyxJQUFJLEVBQUUsU0FBUztJQUNmLE1BQU0sRUFBRSx3QkFBVSxDQUFDLFNBQVMsQ0FBQyxXQUFJLENBQUMsU0FBUyxFQUFFLHVCQUF1QixDQUFDLENBQUM7SUFDdEUsbUJBQW1CLEVBQUU7UUFDbkIsb0JBQW9CLEVBQUU7WUFDcEIsaUJBQWlCLEVBQUUsK0JBQWlCLENBQUMsU0FBUztZQUM5QyxjQUFjLEVBQUU7Z0JBQ2QsUUFBUTthQUNUO1NBQ0Y7UUFDRCw0QkFBNEIsRUFBRTtZQUM1QjtnQkFDRSxpQkFBaUIsRUFBRSwrQkFBaUIsQ0FBQyxPQUFPO2FBQzdDO1NBQ0Y7S0FDRjtDQUNGLENBQUMsQ0FBQztBQUVILE1BQU0sTUFBTSxHQUFHLEdBQUcsQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQztBQUUvRCxNQUFNLENBQUMsY0FBYyxDQUFDLHdCQUF3QixFQUFFO0lBQzlDLFFBQVEsRUFBRSxPQUFPO0lBQ2pCLFNBQVMs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akMsc0JBQXNCLEVBQUUsNkJBQWUsQ0FBQyxlQUFlLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFDekUsdUJBQXVCLEVBQUUsNkJBQWUsQ0FBQyxrQkFBa0IsRUFBRTtDQUM5RCxDQUFDLENBQUM7QUFDSCxTQUFTLENBQUMsY0FBYyxDQUFDLHFCQUFxQixFQUFFO0lBQzlDLFFBQVEsRUFBRSxVQUFVO0lBQ3BCLFNBQVMsRUFBRSxhQUFhO0lBQ3hCLHNCQUFzQixFQUFFLDZCQUFlLENBQUMsZUFBZSxDQUFDLHdCQUFVLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFLG9CQUFNLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBQ3hILHVCQUF1QixFQUFFLDZCQUFlLENBQUMsa0JBQWtCLEVBQUU7Q0FDOUQsQ0FBQyxDQUFDO0FBRUgsTUFBTSxNQUFNLEdBQUcsR0FBRyxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSx5QkFBeUIsRUFBRSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDO0FBRXhGLE1BQU0sQ0FBQyxjQUFjLENBQUMscUJBQXFCLEVBQUU7SUFDM0MsUUFBUSxFQUFFLFVBQVU7SUFDcEIsU0FBUyxFQUFFLGFBQWE7SUFDeEIsc0JBQXNCLEVBQUUsNkJBQWUsQ0FBQyxVQUFVLENBQUM7Ozs7Ozs7Ozs7OztJQVlqRCxDQUFDO0lBQ0gsdUJBQXVCLEVBQUUsNkJBQWUsQ0FBQyxVQUFVLENBQUM7Ozs7Ozs7Ozs7Ozs7R0FhbkQsQ0FBQztDQUNILENBQUMsQ0FBQztBQUVILEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGpvaW4gfSBmcm9tICdwYXRoJztcbmltcG9ydCB7IFVzZXJQb29sIH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWNvZ25pdG8nO1xuaW1wb3J0IHsgQXR0cmlidXRlVHlwZSwgQmlsbGluZ01vZGUsIFRhYmxlIH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWR5bmFtb2RiJztcbmltcG9ydCB7IEFwcCwgUmVtb3ZhbFBvbGljeSwgU3RhY2sgfSBmcm9tICdhd3MtY2RrLWxpYic7XG5pbXBvcnQge1xuICBBdXRob3JpemF0aW9uVHlwZSxcbiAgR3JhcGhxbEFwaSxcbiAgS2V5Q29uZGl0aW9uLFxuICBNYXBwaW5nVGVtcGxhdGUsXG4gIFByaW1hcnlLZXksXG4gIFNjaGVtYUZpbGUsXG4gIFZhbHVlcyxcbn0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWFwcHN5bmMnO1xuXG4vKlxuICogQ3JlYXRlcyBhbiBBcHBzeW5jIEdyYXBoUUwgQVBJIGFuZCB3aXRoIG11bHRpcGxlIHRhYmxlcy5cbiAqIFRlc3RpbmcgZm9yIGltcG9ydGluZywgcXVlcnlpbmcsIGFuZCBtdXRhYmlsaXR5LlxuICpcbiAqIFN0YWNrIHZlcmlmaWNhdGlvbiBzdGVwczpcbiAqIEFkZCB0byBhIHRhYmxlIHRocm91Z2ggYXBwc3luYyBHcmFwaFFMIEFQSS5cbiAqIFJlYWQgZnJvbSBhIHRhYmxlIHRocm91Z2ggYXBwc3luYyBBUEkuXG4gKlxuICogLS0gYXdzIGFwcHN5bmMgbGlzdC1ncmFwaHFsLWFwaXMgICAgICAgICAgICAgICAgIC0tIG9idGFpbiBhcGlJZCAgICAgICAgICAgICAgIC0tXG4gKiAtLSBhd3MgYXBwc3luYyBnZXQtZ3JhcGhxbC1hcGkgLS1hcGktaWQgW2FwaUlkXSAgLS0gb2J0YWluIEdyYXBoUUwgZW5kcG9pbnQgICAgLS1cbiAqIC0tIGF3cyBhcHBzeW5jIGxpc3QtYXBpLWtleXMgLS1hcGktaWQgW2FwaUlkXSAgICAtLSBvYnRhaW4gYXBpIGtleSAgICAgICAgICAgICAtLVxuICogLS0gYmFzaCB2ZXJpZnkuaW50ZWcuZ3JhcGhxbC5zaCBbYXBpS2V5XSBbdXJsXSAgIC0tIHNob3dzIHF1ZXJ5IGFuZCBtdXRhdGlvbiAgIC0tXG4gKi9cblxuY29uc3QgYXBwID0gbmV3IEFwcCgpO1xuY29uc3Qgc3RhY2sgPSBuZXcgU3RhY2soYXBwLCAnYXdzLWFwcHN5bmMtaW50ZWcnKTtcblxuY29uc3QgdXNlclBvb2wgPSBuZXcgVXNlclBvb2woc3RhY2ssICdQb29sJywge1xuICB1c2VyUG9vbE5hbWU6ICdteVBvb2wnLFxufSk7XG5cbmNvbnN0IGFwaSA9IG5ldyBHcmFwaHFsQXBpKHN0YWNrLCAnQXBpJywge1xuICBuYW1lOiAnZGVtb2FwaScsXG4gIHNjaGVtYTogU2NoZW1hRmlsZS5mcm9tQXNzZXQoam9pbihfX2Rpcm5hbWUsICdpbnRlZy5ncmFwaHFsLmdyYXBocWwnKSksXG4gIGF1dGhvcml6YXRpb25Db25maWc6IHtcbiAgICBkZWZhdWx0QXV0aG9yaXphdGlvbjoge1xuICAgICAgYXV0aG9yaXphdGlvblR5cGU6IEF1dGhvcml6YXRpb25UeXBlLlVTRVJfUE9PTCxcbiAgICAgIHVzZXJQb29sQ29uZmlnOiB7XG4gICAgICAgIHVzZXJQb29sLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGFkZGl0aW9uYWxBdXRob3JpemF0aW9uTW9kZXM6IFtcbiAgICAgIHtcbiAgICAgICAgYXV0aG9yaXphdGlvblR5cGU6IEF1dGhvcml6YXRpb25UeXBlLkFQSV9LRVksXG4gICAgICB9LFxuICAgIF0sXG4gIH0sXG59KTtcblxuY29uc3Qgbm9uZURTID0gYXBpLmFkZE5vbmVEYXRhU291cmNlKCdub25lJywgeyBuYW1lOiAnTm9uZScgfSk7XG5cbm5vbmVEUy5jcmVhdGVSZXNvbHZlcignUXVlcnlnZXRTZXJ2aWNlVmVyc2lvbicsIHtcbiAgdHlwZU5hbWU6ICdRdWVyeScsXG4gIGZpZWxkTmFtZTogJ2dldFNlcnZpY2VWZXJzaW9uJyxcbiAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmZyb21TdHJpbmcoSlNPTi5zdHJpbmdpZnkoe1xuICAgIHZlcnNpb246ICcyMDE3LTAyLTI4JyxcbiAgfSkpLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmZyb21TdHJpbmcoSlNPTi5zdHJpbmdpZnkoe1xuICAgIHZlcnNpb246ICd2MScsXG4gIH0pKSxcbn0pO1xuXG5jb25zdCBjdXN0b21lclRhYmxlID0gbmV3IFRhYmxlKHN0YWNrLCAnQ3VzdG9tZXJUYWJsZScsIHtcbiAgYmlsbGluZ01vZGU6IEJpbGxpbmdNb2RlLlBBWV9QRVJfUkVRVUVTVCxcbiAgcGFydGl0aW9uS2V5OiB7XG4gICAgbmFtZTogJ2lkJyxcbiAgICB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyxcbiAgfSxcbiAgcmVtb3ZhbFBvbGljeTogUmVtb3ZhbFBvbGljeS5ERVNUUk9ZLFxufSk7XG5jb25zdCBvcmRlclRhYmxlID0gbmV3IFRhYmxlKHN0YWNrLCAnT3JkZXJUYWJsZScsIHtcbiAgYmlsbGluZ01vZGU6IEJpbGxpbmdNb2RlLlBBWV9QRVJfUkVRVUVTVCxcbiAgcGFydGl0aW9uS2V5OiB7XG4gICAgbmFtZTogJ2N1c3RvbWVyJyxcbiAgICB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyxcbiAgfSxcbiAgc29ydEtleToge1xuICAgIG5hbWU6ICdvcmRlcicsXG4gICAgdHlwZTogQXR0cmlidXRlVHlwZS5TVFJJTkcsXG4gIH0sXG4gIHJlbW92YWxQb2xpY3k6IFJlbW92YWxQb2xpY3kuREVTVFJPWSxcbn0pO1xub3JkZXJUYWJsZS5hZGRHbG9iYWxTZWNvbmRhcnlJbmRleCh7XG4gIGluZGV4TmFtZTogJ29yZGVySW5kZXgnLFxuICBwYXJ0aXRpb25LZXk6IHtcbiAgICBuYW1lOiAnb3JkZXInLFxuICAgIHR5cGU6IEF0dHJpYnV0ZVR5cGUuU1RSSU5HLFxuICB9LFxuICBzb3J0S2V5OiB7XG4gICAgbmFtZTogJ2N1c3RvbWVyJyxcbiAgICB0eXBlOiBBdHRyaWJ1dGVUeXBlLlNUUklORyxcbiAgfSxcbn0pO1xuXG5uZXcgVGFibGUoc3RhY2ssICdQYXltZW50VGFibGUnLCB7XG4gIGJpbGxpbmdNb2RlOiBCaWxsaW5nTW9kZS5QQVlfUEVSX1JFUVVFU1QsXG4gIHBhcnRpdGlvbktleToge1xuICAgIG5hbWU6ICdpZCcsXG4gICAgdHlwZTogQXR0cmlidXRlVHlwZS5TVFJJTkcsXG4gIH0sXG4gIHJlbW92YWxQb2xpY3k6IFJlbW92YWxQb2xpY3kuREVTVFJPWSxcbn0pO1xuXG5jb25zdCBwYXltZW50VGFibGUgPSBUYWJsZS5mcm9tVGFibGVOYW1lKHN0YWNrLCAnSW1wb3J0ZWRQYXltZW50VGFibGUnLCAnUGF5bWVudFRhYmxlJyk7XG5cbmNvbnN0IGN1c3RvbWVyRFMgPSBhcGkuYWRkRHluYW1vRGJEYXRhU291cmNlKCdjdXN0b21lckRzJywgY3VzdG9tZXJUYWJsZSwgeyBuYW1lOiAnQ3VzdG9tZXInIH0pO1xuY29uc3Qgb3JkZXJEUyA9IGFwaS5hZGREeW5hbW9EYkRhdGFTb3VyY2UoJ29yZGVyRHMnLCBvcmRlclRhYmxlLCB7IG5hbWU6ICdPcmRlcicgfSk7XG5jb25zdCBwYXltZW50RFMgPSBhcGkuYWRkRHluYW1vRGJEYXRhU291cmNlKCdwYXltZW50RHMnLCBwYXltZW50VGFibGUsIHsgbmFtZTogJ1BheW1lbnQnIH0pO1xuXG5jdXN0b21lckRTLmNyZWF0ZVJlc29sdmVyKCdRdWVyeUdldEN1c3RvbWVycycsIHtcbiAgdHlwZU5hbWU6ICdRdWVyeScsXG4gIGZpZWxkTmFtZTogJ2dldEN1c3RvbWVycycsXG4gIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlNjYW5UYWJsZSgpLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0TGlzdCgpLFxufSk7XG5jdXN0b21lckRTLmNyZWF0ZVJlc29sdmVyKCdRdWVyeUdldEN1c3RvbWVyJywge1xuICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgZmllbGROYW1lOiAnZ2V0Q3VzdG9tZXInLFxuICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJHZXRJdGVtKCdpZCcsICdpZCcpLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0SXRlbSgpLFxufSk7XG5jdXN0b21lckRTLmNyZWF0ZVJlc29sdmVyKCdRdWVyeUdldEN1c29tdGVyc05vdENvbnNpc3RlbnQnLCB7XG4gIHR5cGVOYW1lOiAnUXVlcnknLFxuICBmaWVsZE5hbWU6ICdnZXRDdXN0b21lcnNOb3RDb25zaXN0ZW50JyxcbiAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiU2NhblRhYmxlKGZhbHNlKSxcbiAgcmVzcG9uc2VNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlJlc3VsdExpc3QoKSxcbn0pO1xuY3VzdG9tZXJEUy5jcmVhdGVSZXNvbHZlcignUXVlcnlHZXRDdXN0b21lck5vdENvbnNpc3RlbnQnLCB7XG4gIHR5cGVOYW1lOiAnUXVlcnknLFxuICBmaWVsZE5hbWU6ICdnZXRDdXN0b21lck5vdENvbnNpc3RlbnQnLFxuICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJHZXRJdGVtKCdpZCcsICdpZCcsIGZhbHNlKSxcbiAgcmVzcG9uc2VNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlJlc3VsdEl0ZW0oKSxcbn0pO1xuY3VzdG9tZXJEUy5jcmVhdGVSZXNvbHZlcignUXVlcnlHZXRDdXN0b21lcnNDb25zaXN0ZW50Jywge1xuICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgZmllbGROYW1lOiAnZ2V0Q3VzdG9tZXJzQ29uc2lzdGVudCcsXG4gIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlNjYW5UYWJsZSh0cnVlKSxcbiAgcmVzcG9uc2VNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlJlc3VsdExpc3QoKSxcbn0pO1xuY3VzdG9tZXJEUy5jcmVhdGVSZXNvbHZlcignUXVlcnlHZXRDdXN0b21lckNvbnNpc3RlbnQnLCB7XG4gIHR5cGVOYW1lOiAnUXVlcnknLFxuICBmaWVsZE5hbWU6ICdnZXRDdXN0b21lckNvbnNpc3RlbnQnLFxuICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJHZXRJdGVtKCdpZCcsICdpZCcsIHRydWUpLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0SXRlbSgpLFxufSk7XG5jdXN0b21lckRTLmNyZWF0ZVJlc29sdmVyKCdNdXRhdGlvbkFkZEN1c3RvbWVyJywge1xuICB0eXBlTmFtZTogJ011dGF0aW9uJyxcbiAgZmllbGROYW1lOiAnYWRkQ3VzdG9tZXInLFxuICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJQdXRJdGVtKFByaW1hcnlLZXkucGFydGl0aW9uKCdpZCcpLmF1dG8oKSwgVmFsdWVzLnByb2plY3RpbmcoJ2N1c3RvbWVyJykpLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0SXRlbSgpLFxufSk7XG5jdXN0b21lckRTLmNyZWF0ZVJlc29sdmVyKCdNdXRhdGlvblNhdmVDdXN0b21lcicsIHtcbiAgdHlwZU5hbWU6ICdNdXRhdGlvbicsXG4gIGZpZWxkTmFtZTogJ3NhdmVDdXN0b21lcicsXG4gIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlB1dEl0ZW0oUHJpbWFyeUtleS5wYXJ0aXRpb24oJ2lkJykuaXMoJ2lkJyksIFZhbHVlcy5wcm9qZWN0aW5nKCdjdXN0b21lcicpKSxcbiAgcmVzcG9uc2VNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlJlc3VsdEl0ZW0oKSxcbn0pO1xuY3VzdG9tZXJEUy5jcmVhdGVSZXNvbHZlcignTXV0YXRpb25TYXZlQ3VzdG9tZXJXaXRoRmlyc3RPcmRlcicsIHtcbiAgdHlwZU5hbWU6ICdNdXRhdGlvbicsXG4gIGZpZWxkTmFtZTogJ3NhdmVDdXN0b21lcldpdGhGaXJzdE9yZGVyJyxcbiAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUHV0SXRlbShcbiAgICBQcmltYXJ5S2V5XG4gICAgICAucGFydGl0aW9uKCdvcmRlcicpLmF1dG8oKVxuICAgICAgLnNvcnQoJ2N1c3RvbWVyJykuaXMoJ2N1c3RvbWVyLmlkJyksXG4gICAgVmFsdWVzXG4gICAgICAucHJvamVjdGluZygnb3JkZXInKVxuICAgICAgLmF0dHJpYnV0ZSgncmVmZXJyYWwnKS5pcygncmVmZXJyYWwnKSksXG4gIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRJdGVtKCksXG59KTtcbmN1c3RvbWVyRFMuY3JlYXRlUmVzb2x2ZXIoJ011dGF0aW9uUmVtb3ZlQ3VzdG9tZXInLCB7XG4gIHR5cGVOYW1lOiAnTXV0YXRpb24nLFxuICBmaWVsZE5hbWU6ICdyZW1vdmVDdXN0b21lcicsXG4gIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYkRlbGV0ZUl0ZW0oJ2lkJywgJ2lkJyksXG4gIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRJdGVtKCksXG59KTtcblxuY29uc3Qgb3BzID0gW1xuICB7IHN1ZmZpeDogJ0VxJywgb3A6IEtleUNvbmRpdGlvbi5lcSB9LFxuICB7IHN1ZmZpeDogJ0x0Jywgb3A6IEtleUNvbmRpdGlvbi5sdCB9LFxuICB7IHN1ZmZpeDogJ0xlJywgb3A6IEtleUNvbmRpdGlvbi5sZSB9LFxuICB7IHN1ZmZpeDogJ0d0Jywgb3A6IEtleUNvbmRpdGlvbi5ndCB9LFxuICB7IHN1ZmZpeDogJ0dlJywgb3A6IEtleUNvbmRpdGlvbi5nZSB9LFxuXTtcbmZvciAoY29uc3QgeyBzdWZmaXgsIG9wIH0gb2Ygb3BzKSB7XG4gIG9yZGVyRFMuY3JlYXRlUmVzb2x2ZXIoYFF1ZXJ5R2V0Q3VzdG9tZXJPcmRlcnMke3N1ZmZpeH1gLCB7XG4gICAgdHlwZU5hbWU6ICdRdWVyeScsXG4gICAgZmllbGROYW1lOiAnZ2V0Q3VzdG9tZXJPcmRlcnMnICsgc3VmZml4LFxuICAgIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlF1ZXJ5KG9wKCdjdXN0b21lcicsICdjdXN0b21lcicpKSxcbiAgICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0TGlzdCgpLFxuICB9KTtcbiAgb3JkZXJEUy5jcmVhdGVSZXNvbHZlcihgUXVlcnlHZXRPcmRlckN1c3RvbWVycyR7c3VmZml4fWAsIHtcbiAgICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgICBmaWVsZE5hbWU6ICdnZXRPcmRlckN1c3RvbWVycycgKyBzdWZmaXgsXG4gICAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUXVlcnkob3AoJ29yZGVyJywgJ29yZGVyJyksICdvcmRlckluZGV4JyksXG4gICAgcmVzcG9uc2VNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlJlc3VsdExpc3QoKSxcbiAgfSk7XG59XG5mb3IgKGNvbnN0IHsgc3VmZml4LCBvcCB9IG9mIG9wcykge1xuICBvcmRlckRTLmNyZWF0ZVJlc29sdmVyKGBRdWVyeUdldEN1c3RvbWVyT3JkZXJzTm90Q29uc2lzdGVudCR7c3VmZml4fWAsIHtcbiAgICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgICBmaWVsZE5hbWU6ICdnZXRDdXN0b21lck9yZGVyc05vdENvbnNpc3RlbnQnICsgc3VmZml4LFxuICAgIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlF1ZXJ5KG9wKCdjdXN0b21lcicsICdjdXN0b21lcicpLCB1bmRlZmluZWQsIGZhbHNlKSxcbiAgICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0TGlzdCgpLFxuICB9KTtcbiAgb3JkZXJEUy5jcmVhdGVSZXNvbHZlcihgUXVlcnlHZXRPcmRlckN1c3RvbWVyc05vdENvbnNpc3RlbnQke3N1ZmZpeH1gLCB7XG4gICAgdHlwZU5hbWU6ICdRdWVyeScsXG4gICAgZmllbGROYW1lOiAnZ2V0T3JkZXJDdXN0b21lcnNOb3RDb25zaXN0ZW50JyArIHN1ZmZpeCxcbiAgICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJRdWVyeShvcCgnb3JkZXInLCAnb3JkZXInKSwgJ29yZGVySW5kZXgnLCBmYWxzZSksXG4gICAgcmVzcG9uc2VNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlJlc3VsdExpc3QoKSxcbiAgfSk7XG59XG5mb3IgKGNvbnN0IHsgc3VmZml4LCBvcCB9IG9mIG9wcykge1xuICBvcmRlckRTLmNyZWF0ZVJlc29sdmVyKGBRdWVyeUdldEN1c3RvbWVyT3JkZXJzQ29uc2lzdGVudCR7c3VmZml4fWAsIHtcbiAgICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgICBmaWVsZE5hbWU6ICdnZXRDdXN0b21lck9yZGVyc0NvbnNpc3RlbnQnICsgc3VmZml4LFxuICAgIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlF1ZXJ5KG9wKCdjdXN0b21lcicsICdjdXN0b21lcicpLCB1bmRlZmluZWQsIHRydWUpLFxuICAgIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRMaXN0KCksXG4gIH0pO1xuICBvcmRlckRTLmNyZWF0ZVJlc29sdmVyKGBRdWVyeUdldE9yZGVyQ3VzdG9tZXJzQ29uc2lzdGVudCR7c3VmZml4fWAsIHtcbiAgICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgICBmaWVsZE5hbWU6ICdnZXRPcmRlckN1c3RvbWVyc0NvbnNpc3RlbnQnICsgc3VmZml4LFxuICAgIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlF1ZXJ5KG9wKCdvcmRlcicsICdvcmRlcicpLCAnb3JkZXJJbmRleCcsIHRydWUpLFxuICAgIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRMaXN0KCksXG4gIH0pO1xufVxub3JkZXJEUy5jcmVhdGVSZXNvbHZlcignUXVlcnlHZXRDdXN0b21lck9yZGVyc0ZpbHRlcicsIHtcbiAgdHlwZU5hbWU6ICdRdWVyeScsXG4gIGZpZWxkTmFtZTogJ2dldEN1c3RvbWVyT3JkZXJzRmlsdGVyJyxcbiAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUXVlcnkoXG4gICAgS2V5Q29uZGl0aW9uLmVxKCdjdXN0b21lcicsICdjdXN0b21lcicpLmFuZChLZXlDb25kaXRpb24uYmVnaW5zV2l0aCgnb3JkZXInLCAnb3JkZXInKSkpLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0TGlzdCgpLFxufSk7XG5vcmRlckRTLmNyZWF0ZVJlc29sdmVyKCdRdWVyeUdldEN1c3RvbWVyT3JkZXJzQmV0d2VlbicsIHtcbiAgdHlwZU5hbWU6ICdRdWVyeScsXG4gIGZpZWxkTmFtZTogJ2dldEN1c3RvbWVyT3JkZXJzQmV0d2VlbicsXG4gIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlF1ZXJ5KFxuICAgIEtleUNvbmRpdGlvbi5lcSgnY3VzdG9tZXInLCAnY3VzdG9tZXInKS5hbmQoS2V5Q29uZGl0aW9uLmJldHdlZW4oJ29yZGVyJywgJ29yZGVyMScsICdvcmRlcjInKSkpLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0TGlzdCgpLFxufSk7XG5vcmRlckRTLmNyZWF0ZVJlc29sdmVyKCdRdWVyeUdldE9yZGVyQ3VzdG9tZXJzRmlsdGVyJywge1xuICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgZmllbGROYW1lOiAnZ2V0T3JkZXJDdXN0b21lcnNGaWx0ZXInLFxuICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJRdWVyeShcbiAgICBLZXlDb25kaXRpb24uZXEoJ29yZGVyJywgJ29yZGVyJykuYW5kKEtleUNvbmRpdGlvbi5iZWdpbnNXaXRoKCdjdXN0b21lcicsICdjdXN0b21lcicpKSksXG4gIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRMaXN0KCksXG59KTtcbm9yZGVyRFMuY3JlYXRlUmVzb2x2ZXIoJ1F1ZXJ5R2V0T3JkZXJDdXN0b21lcnNCZXR3ZWVuJywge1xuICB0eXBlTmFtZTogJ1F1ZXJ5JyxcbiAgZmllbGROYW1lOiAnZ2V0T3JkZXJDdXN0b21lcnNCZXR3ZWVuJyxcbiAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUXVlcnkoXG4gICAgS2V5Q29uZGl0aW9uLmVxKCdvcmRlcicsICdvcmRlcicpLmFuZChLZXlDb25kaXRpb24uYmV0d2VlbignY3VzdG9tZXInLCAnY3VzdG9tZXIxJywgJ2N1c3RvbWVyMicpKSwgJ29yZGVySW5kZXgnKSxcbiAgcmVzcG9uc2VNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYlJlc3VsdExpc3QoKSxcbn0pO1xuXG5wYXltZW50RFMuY3JlYXRlUmVzb2x2ZXIoJ1F1ZXJ5R2V0UGF5bWVudCcsIHtcbiAgdHlwZU5hbWU6ICdRdWVyeScsXG4gIGZpZWxkTmFtZTogJ2dldFBheW1lbnQnLFxuICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJHZXRJdGVtKCdpZCcsICdpZCcpLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0SXRlbSgpLFxufSk7XG5wYXltZW50RFMuY3JlYXRlUmVzb2x2ZXIoJ1F1ZXJ5R2V0UGF5bWVudENvbnNpc3RlbnQnLCB7XG4gIHR5cGVOYW1lOiAnUXVlcnknLFxuICBmaWVsZE5hbWU6ICdnZXRQYXltZW50Q29uc2lzdGVudCcsXG4gIHJlcXVlc3RNYXBwaW5nVGVtcGxhdGU6IE1hcHBpbmdUZW1wbGF0ZS5keW5hbW9EYkdldEl0ZW0oJ2lkJywgJ2lkJywgdHJ1ZSksXG4gIHJlc3BvbnNlTWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZHluYW1vRGJSZXN1bHRJdGVtKCksXG59KTtcbnBheW1lbnREUy5jcmVhdGVSZXNvbHZlcignTXV0YXRpb25TYXZlUGF5bWVudCcsIHtcbiAgdHlwZU5hbWU6ICdNdXRhdGlvbicsXG4gIGZpZWxkTmFtZTogJ3NhdmVQYXltZW50JyxcbiAgcmVxdWVzdE1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUHV0SXRlbShQcmltYXJ5S2V5LnBhcnRpdGlvbignaWQnKS5hdXRvKCksIFZhbHVlcy5wcm9qZWN0aW5nKCdwYXltZW50JykpLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmR5bmFtb0RiUmVzdWx0SXRlbSgpLFxufSk7XG5cbmNvbnN0IGh0dHBEUyA9IGFwaS5hZGRIdHRwRGF0YVNvdXJjZSgnZHMnLCAnaHR0cHM6Ly9hd3MuYW1hem9uLmNvbS8nLCB7IG5hbWU6ICdodHRwJyB9KTtcblxuaHR0cERTLmNyZWF0ZVJlc29sdmVyKCdNdXRhdGlvbkRvUG9zdE9uQXdzJywge1xuICB0eXBlTmFtZTogJ011dGF0aW9uJyxcbiAgZmllbGROYW1lOiAnZG9Qb3N0T25Bd3MnLFxuICByZXF1ZXN0TWFwcGluZ1RlbXBsYXRlOiBNYXBwaW5nVGVtcGxhdGUuZnJvbVN0cmluZyhge1xuICAgIFwidmVyc2lvblwiOiBcIjIwMTgtMDUtMjlcIixcbiAgICBcIm1ldGhvZFwiOiBcIlBPU1RcIixcbiAgICAjIGlmIGZ1bGwgcGF0aCBpcyBodHRwczovL2FwaS54eHh4eHh4eHguY29tL3Bvc3RzIHRoZW4gcmVzb3VyY2VQYXRoIHdvdWxkIGJlIC9wb3N0c1xuICAgIFwicmVzb3VyY2VQYXRoXCI6IFwiL3BhdGgvMTIzXCIsXG4gICAgXCJwYXJhbXNcIjp7XG4gICAgICAgIFwiYm9keVwiOiAkdXRpbC50b0pzb24oJGN0eC5hcmdzKSxcbiAgICAgICAgXCJoZWFkZXJzXCI6e1xuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgICBcIkF1dGhvcml6YXRpb25cIjogXCIkY3R4LnJlcXVlc3QuaGVhZGVycy5BdXRob3JpemF0aW9uXCJcbiAgICAgICAgfVxuICAgIH1cbiAgfWApLFxuICByZXNwb25zZU1hcHBpbmdUZW1wbGF0ZTogTWFwcGluZ1RlbXBsYXRlLmZyb21TdHJpbmcoYFxuICAgICMjIFJhaXNlIGEgR3JhcGhRTCBmaWVsZCBlcnJvciBpbiBjYXNlIG9mIGEgZGF0YXNvdXJjZSBpbnZvY2F0aW9uIGVycm9yXG4gICAgI2lmKCRjdHguZXJyb3IpXG4gICAgICAkdXRpbC5lcnJvcigkY3R4LmVycm9yLm1lc3NhZ2UsICRjdHguZXJyb3IudHlwZSlcbiAgICAjZW5kXG4gICAgIyMgaWYgdGhlIHJlc3BvbnNlIHN0YXR1cyBjb2RlIGlzIG5vdCAyMDAsIHRoZW4gcmV0dXJuIGFuIGVycm9yLiBFbHNlIHJldHVybiB0aGUgYm9keSAqKlxuICAgICNpZigkY3R4LnJlc3VsdC5zdGF0dXNDb2RlID09IDIwMClcbiAgICAgICAgIyMgSWYgcmVzcG9uc2UgaXMgMjAwLCByZXR1cm4gdGhlIGJvZHkuXG4gICAgICAgICRjdHgucmVzdWx0LmJvZHlcbiAgICAjZWxzZVxuICAgICAgICAjIyBJZiByZXNwb25zZSBpcyBub3QgMjAwLCBhcHBlbmQgdGhlIHJlc3BvbnNlIHRvIGVycm9yIGJsb2NrLlxuICAgICAgICAkdXRpbHMuYXBwZW5kRXJyb3IoJGN0eC5yZXN1bHQuYm9keSwgXCIkY3R4LnJlc3VsdC5zdGF0dXNDb2RlXCIpXG4gICAgI2VuZFxuICBgKSxcbn0pO1xuXG5hcHAuc3ludGgoKTtcbiJdfQ==